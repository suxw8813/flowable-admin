webpackJsonp([6],{LUhM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={name:"startProcess",data:function(){return{templateDialog:this.templateVisible,formData:{orderCode:null,processDefinitionId:null},processDefinitionList:[{name:"专利-发明专用流程",id:"1",version:21}]}},props:{templateVisible:{type:Boolean,default:!1}},watch:{templateVisible:function(){this.templateDialog=this.templateVisible}},methods:{closeDia:function(){this.$emit("update:templateVisible",!1)},openDia:function(){var e=this;this.$axios.get(this.$api.flowableapi+"repository/process-definitions",{params:{size:500}}).then(function(t){e.processDefinitionList=t.data.data}).catch(function(t){e.$message.error(t.toString())})},startProcess:function(){var e=this;this.$axios.post(this.$api.flowableapi+"runtime/process-instances",{processDefinitionId:this.formData.processDefinitionId,businessKey:this.formData.orderCode},{}).then(function(t){201!==t.status?e.$message.error(t.statusText):(e.$message.success(t.statusText),e.formData.orderCode=null,e.formData.processDefinitionId=null,e.templateDialog=!1)}).catch(function(t){e.$message.error(t.toString())})}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"启动流程",width:"30%",top:"150px","close-on-click-modal":!1,visible:e.templateDialog,center:!0},on:{close:e.closeDia,open:e.openDia}},[a("el-form",{ref:"formData",attrs:{model:e.formData,"label-width":"130px",size:"large"}},[a("el-form-item",{attrs:{label:"订单号："}},[a("el-input",{model:{value:e.formData.orderCode,callback:function(t){e.$set(e.formData,"orderCode",t)},expression:"formData.orderCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"业务分类："}},[a("el-select",{attrs:{placeholder:"请选择流程"},model:{value:e.formData.processDefinitionId,callback:function(t){e.$set(e.formData,"processDefinitionId",t)},expression:"formData.processDefinitionId"}},e._l(e.processDefinitionList,function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.id}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.version))])])}))],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.templateDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.startProcess()}}},[e._v("启 动")])],1)],1)},staticRenderFns:[]};var o={name:"process",components:{startProcess:a("VU/8")(i,n,!1,function(e){a("ZUh+")},"data-v-529776bf",null).exports,imgDialog:a("RxVx").a},data:function(){return{templateVisible:!1,imgDialogVisible:!1,processDefinitionId:null,processInstanceId:null,form:{orderCode:null,processName:null,productName:null,finished:!1,startTimeRange:[],endTimeRange:[]},tableData:{pageNo:1,pageSize:10,totalCount:0,list:[]},pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}}},created:function(){this.findData()},computed:{start:function(){return(this.tableData.pageNo-1)*this.tableData.pageSize}},methods:{handleSizeChange:function(e){this.tableData.pageSize=e,this.findData()},handleCurrentChange:function(e){this.tableData.pageNo=e,this.findData()},handlePrevChange:function(e){this.tableData.pageNo=e},handleNextChange:function(e){this.tableData.pageNo=e},findData:function(){var e=this;this.$axios.get(this.$api.deploymentApi+"repository/deployments",{headers:{"Content-Type":"application/json"},params:{start:e.start,pageSize:e.tableData.pageSize}}).then(function(t){e.tableData.list=t.data.data.list,e.tableData.totalCount=t.data.data.total}).catch(function(t){e.$message.error(t.toString())})},getDiagramByInstanceId:function(e){this.processInstanceId=e,this.imgDialogVisible=!0},getDiagramByDefinitionId:function(e){this.processDefinitionId=e,this.imgDialogVisible=!0},cancelProcessInstance:function(e){var t=this;this.$axios.delete(this.$api.flowableapi+"runtime/process-instances/"+e,{}).then(function(e){204!==e.status?t.$message.error(e.statusText):(t.$message.success("deleted"),t.findData())}).catch(function(e){t.$message.error(e.toString())})},turnToTask:function(e){this.$router.push("/home/workbench/task/"+e)}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-form",{ref:"form",attrs:{model:e.form,inline:!0,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"KEY",prop:"key"}},[a("el-input",{model:{value:e.form.key,callback:function(t){e.$set(e.form,"key",t)},expression:"form.key"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"租户",prop:"tenantId"}},[a("el-input",{model:{value:e.form.tenantId,callback:function(t){e.$set(e.form,"tenantId",t)},expression:"form.tenantId"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.findData}},[e._v("查询")]),e._v(" "),a("el-button",{on:{click:function(t){e.$refs.form.resetFields()}}},[e._v("重置")])],1),e._v(" "),a("el-form-item",{attrs:{labelPosition:"right"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.templateVisible=!0}}},[e._v("启动流程")])],1)],1)],1),e._v(" "),a("el-row",[a("el-table",{attrs:{data:e.tableData.list,border:""}},[a("el-table-column",{attrs:{type:"index",label:"NO."}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"key",label:"KEY"}}),e._v(" "),a("el-table-column",{attrs:{prop:"description",label:"描述"}}),e._v(" "),e.form.finished?[a("el-table-column",{attrs:{prop:"endTime",label:"结束时间"}})]:e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"version",label:"版本",width:"50px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"tenantId",label:"租户",width:"100px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"suspensionState",label:"流程状态",width:"80px"}}),e._v(" "),a("el-table-column",{attrs:{prop:"deployTime",label:"部署时间",width:"170px"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.getDiagramByDefinitionId(t.row.processDefinitionId)}}},[e._v("任务列表")])]}}])})],2),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":e.tableData.pageNo,"page-size":e.tableData.pageSize,"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:e.tableData.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"prev-click":e.handlePrevChange,"next-click":e.handleNextChange}})],1)],1),e._v(" "),a("startProcess",{attrs:{templateVisible:e.templateVisible},on:{"update:templateVisible":function(t){e.templateVisible=t}}}),e._v(" "),a("imgDialog",{attrs:{imgDialogVisible:e.imgDialogVisible,processDefinitionId:e.processDefinitionId,processInstanceId:e.processInstanceId},on:{"update:imgDialogVisible":function(t){e.imgDialogVisible=t}}})],1)},staticRenderFns:[]};var l=a("VU/8")(o,s,!1,function(e){a("ZuXp")},"data-v-176f0e16",null);t.default=l.exports},"ZUh+":function(e,t){},ZuXp:function(e,t){}});
//# sourceMappingURL=6.a6e2233c21f652b1bf82.js.map